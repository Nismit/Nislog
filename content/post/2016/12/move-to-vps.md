+++
draft = false
date = 2016-12-07T19:00:39Z
title = "[VPS]ConoHa VPSに乗り換えました"
description = "CoreserverからConoHaのVPSに乗り換えました。レンタルサーバーでは制限されて出来ない事がほぼ全て行えるVPS。ただし、初期設定からサーバーの運用まで個人でしなければなりません。初めてのVPSという事もあり、アカウントの作成からWordPressを動かすまでの方法の数回に分けて備忘録として残しておきます。"
tags = ["server", "vps"]
eyecatch = ""
toc = true
+++

以前のブログで書いた記事を再編集しました。(2018/01/05)\
レンタルサーバーからVPSに乗り換えました。前々からレンタルサーバーは変えたいと思っており、
VPSを借りて設定やドメイン移行など様々な事を行いました。今後の為に備忘録として残しておきたいと思います。

# した事リスト
VPSは初めて借りたので、色々調べながらしたので回りくどい事もしているかもしれません。
調べている最中にバージョンや人によって書き方が異なる事と一通りのセットアップまでが書かれて無く、部分的にしか見つけれなかったのでまとめて記事にしようと思いました。

- VPSの選定
- アカウント作成/契約、サーバの立ち上げ
- パッケージアップデート
- 作業用ユーザの作成
- SSHの設定(ポートの変更、rootのsshログイン禁止等)
- LAMP環境のセットアップ
- sftp専用ユーザの作成
- Apacheのバーチャルドメイン設定
- Apache/MariaDBの設定
- Let's encrypt(SSL/HTTPS)の設定
- PHP7の導入/OPCache,APCuによるPHP高速化

# VPSの選定
調べて行くと色んな会社がVPSやクラウドのサービスを出していて、悩みましたが有名なところは以下。

- AWS(Amazon Web Service)
- さくらのVPS
- ConoHaのVPS

AWSは勉強したいなと思いましたが、中のサービスが多すぎて手軽に学ぶには難しいそうだなと感じました。
さくらのVPSは王道かつ安定という感じで、あまり考えたくない人にはオススメじゃないでしょうか。僕はなんとなくやめました。
特に理由はないです。ConoHaのVPSも性能、料金も変わらないのですがOSの種類やアプリのインストール済みのテンプレートがあったので、
上手く作れなかった時の保険として便利かもと思って選びました。\
今だとGCP(Google Cloud Platform)も候補に入れてもいいかもしれませんね。

# VPSの契約からサーバの作成
まずは、[ConoHa](https://www.conoha.jp/referral/?token=LzqWKoEVPLE9NxlhMZLBT_RTAnBxkAThfKmD8lDJirkrQsD0cYg-GD6)のサイトへアクセスします。\
アカウント登録を済まして、コントロールパネルに移動して

- 電話/SNS認証のどちらかで本人認証
- 住所など個人情報を入力
- 支払い方法の選択

私は支払いをチャージ方式にしました。これで後はサーバを立てるだけです！
ダッシュボード横のメニューから「サーバーを追加」をクリックします。

私が選択した設定は以下となります。

## プラン

タイプ: VPS\
リージョン: 東京\
メモリ: 2GB\

## イメージ

イメージタイプ: OS\
OS: CentOS\
バージョン: 7.2(64bit) ※最新バージョンで良いと思います\
rootパスワード: 強固なものが良いと思います！\

## オプション

ディスク容量: SSD 20GB\
接続許可ポート IPv4: 全て許可\
接続許可ポート IPv6: 全て許可\
SSH Key: 使用しない\
ネームタグ: お好みで！(e.g. VPS-01等)\

全ての選択が終了したら、値段の横にある「追加」ボタンでサーバを追加します。
これで、サーバ自体は立ったと思います！次はSSHの設定を行いますので、「サーバー」ボタンから先ほど建てたVPSを起動した状態にしてください。
